#include <windows.h>
#include <GL/gl.h>
#include <GL/glut.h>
#include <GL/glu.h>
#include <math.h>
#include <GL/glu.h>
#include <GL/glut.h>


void init(void);
void tampil(void);
void keyboard(unsigned char, int, int);
void ukuran(int, int);
void mouse(int button, int state, int x, int y);
void mouseMotion(int x, int y);


float xrot = 0.0f;
float yrot = 0.0f;
float xdiff = 0.0f;
float ydiff = 0.0f;
bool mouseDown = false;
int is_depth;

void asu()
{
    glLoadIdentity();
       gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);
       glRotatef(xrot, 1.0f,0.0f, 0.0f);
       glRotatef(yrot, 0.0f, 1.0f, 0.0f);
}


void init(void){
  glClearColor(204/255.0f, 255/255.0f, 255/255.0f, 0);
   glMatrixMode(GL_PROJECTION);
   glEnable(GL_DEPTH_TEST);
   is_depth=1;
   glMatrixMode(GL_MODELVIEW);
   glEnable(GL_POINT_SMOOTH);
   glPointSize(5.0f);
   glLineWidth(2.0f);
   	glMatrixMode(GL_PROJECTION);
	glEnable(GL_LIGHTING);
	glEnable(GL_COLOR_MATERIAL);
	glEnable(GL_LIGHT0);
   }
void reshape(int x, int y){
    if( x == 0 || y == 0) return;
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(100, (GLdouble)x/(GLdouble)y, 5, 500);
    glMatrixMode(GL_MODELVIEW);
    glViewport(400, 400, x / 5, y / 5);
}
const double PI = 3.141592653589793;
 int i;

void lingkaran(int jari2, int jumlah_titik, int x_tengah, int y_tengah) {
 glBegin(GL_LINE_STRIP);
 for (i=0;i<=360;i++){
 float sudut=i*(2*PI/jumlah_titik);
 float x=x_tengah+jari2*cos(sudut);
 float y=y_tengah+jari2*sin(sudut);
 glVertex3f(x,0.2,y);
 }
 glEnd();
 }

void renderScene(void) {
 glColor3ub(255,255,255);
 lingkaran(10,100,0,0);
 glFlush();
 glColor3ub(255,255,255);
 lingkaran(7,100,-30,0);
 glFlush();
 glColor3ub(255,255,255);
 lingkaran(7,100,30,0);
 glFlush();
 }

void penonton (void)
{
    //samping_kiri
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(-65,20,15);
    glVertex3f(-65,20,-15);
    glVertex3f(-80,40,-15);
    glVertex3f(-80,40,15);
    glEnd();
//samping_kiri
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(65,20,15);
    glVertex3f(65,20,-15);
    glVertex3f(80,40,-15);
    glVertex3f(80,40,15);
    glEnd();
//depan skat
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(-35,20,50);
    glVertex3f(-10,20,50);
    glVertex3f(-10,40,70);
    glVertex3f(-35,40,70);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(35,20,50);
    glVertex3f(10,20,50);
    glVertex3f(10,40,70);
    glVertex3f(35,40,70);
    glEnd();
//blakang skak
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(-35,20,-50);
    glVertex3f(-10,20,-50);
    glVertex3f(-10,40,-70);
    glVertex3f(-35,40,-70);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glColor3ub(0,0,0);
    glVertex3f(35,20,-50);
    glVertex3f(10,20,-50);
    glVertex3f(10,40,-70);
    glVertex3f(35,40,-70);
    glEnd();
}

void tembok(void)
{

//  tembokdepan
    glBegin(GL_POLYGON);
    glColor3ub(224,224,224);
    glVertex3f(-55,5,68);
    glVertex3f(55,5,68);
    glVertex3f(55,40,75);
    glVertex3f(-55,40,75);
    glEnd();
    glBegin(GL_POLYGON);
    glColor3ub(204,0,0);
    glVertex3f(-55,0,68);
    glVertex3f(55,0,68);
    glVertex3f(55,5,68);
    glVertex3f(-55,5,68);
    glEnd();
    glBegin(GL_POLYGON);
    glVertex3f(-85,0,40);
    glVertex3f(-55,0,68);
    glVertex3f(-55,5,68);
    glVertex3f(-85,5,40);
    glEnd();

//  tembokbelakang
    glBegin(GL_POLYGON);
    glColor3ub(255,255,255);
    glVertex3f(-55,5,-68);
    glVertex3f(55,5,-68);
    glVertex3f(55,40,-75);
    glVertex3f(-55,40,-75);
    glEnd();
    glBegin(GL_POLYGON);
    glColor3ub(204,0,0);
    glVertex3f(-55,0,-68);
    glVertex3f(55,0,-68);
    glVertex3f(55,5,-68);
    glVertex3f(-55,5,-68);
    glEnd();
    glBegin(GL_POLYGON);
    glVertex3f(-55,0,-68);
    glVertex3f(-85,0,-40);
    glVertex3f(-85,5,-40);
    glVertex3f(-55,5,-68);
    glEnd();
    glBegin(GL_POLYGON);
    glVertex3f(55,0,-68);
    glVertex3f(85,0,-40);
    glVertex3f(85,5,-40);
    glVertex3f(55,5,-68);
    glEnd();

//  tembokkiri
    glBegin(GL_POLYGON);
    glColor3ub(255,255,255);
    glVertex3f(-85,5,40);
    glVertex3f(-85,5,-40);
    glVertex3f(-85,40,-40);
    glVertex3f(-85,40,40);
    glEnd();
    glBegin(GL_POLYGON);
    glColor3ub(204,0,0);
    glVertex3f(-85,0,-40);
    glVertex3f(-85,0,40);
    glVertex3f(-85,5,40);
    glVertex3f(-85,5,-40);
    glEnd();


//  tembokkanan
    glBegin(GL_POLYGON);
    glColor3ub(255,255,255);
    glVertex3f(85,5,40);
    glVertex3f(85,5,-40);
    glVertex3f(85,40,-40);
    glVertex3f(85,40,40);
    glEnd();
    glBegin(GL_POLYGON);
    glColor3ub(204,0,0);
    glVertex3f(85,0,-40);
    glVertex3f(85,0,40);
    glVertex3f(85,5,40);
    glVertex3f(85,5,-40);
    glEnd();
    glBegin(GL_POLYGON);
    glVertex3f(85,0,40);
    glVertex3f(55,0,68);
    glVertex3f(55,5,68);
    glVertex3f(85,5,40);
    glEnd();


     //sudut dinding
    glBegin(GL_POLYGON);
    glColor3ub(255,255,255);
    glVertex3f(-85,39.8,-40);
    glVertex3f(-85,5,-40);
    glVertex3f(-55,5,-68);
    glVertex3f(-54.9,40,-75.4);
    glEnd();

    glBegin(GL_POLYGON);
    glVertex3f(85,39.8,-40);
    glVertex3f(85,5,-40);
    glVertex3f(55,5,-68);
    glVertex3f(54.9,40,-75.4);
    glEnd();

    glBegin(GL_POLYGON);
    glVertex3f(85,39.8,40);
    glVertex3f(85,5,40);
    glVertex3f(55,5,68);
    glVertex3f(54.9,40,75.4);
    glEnd();

    glBegin(GL_POLYGON);
    glVertex3f(-85,39.8,40);
    glVertex3f(-85,5,40);
    glVertex3f(-55,5,68);
    glVertex3f(-54.9,40,75.4);
    glEnd();

    //line loop
    //  tembokdepan
    glBegin(GL_LINE_LOOP);
    glColor3ub(169,169,169);
    glVertex3f(-55,5,68);
    glVertex3f(55,5,68);
    glVertex3f(55,40,75);
    glVertex3f(-55,40,75);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(-55,0,68);
    glVertex3f(55,0,68);
    glVertex3f(55,5,68);
    glVertex3f(-55,5,68);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(-85,0,40);
    glVertex3f(-55,0,68);
    glVertex3f(-55,5,68);
    glVertex3f(-85,5,40);
    glEnd();

//  tembokbelakang
    glBegin(GL_LINE_LOOP);
    glVertex3f(-55,5,-68);
    glVertex3f(55,5,-68);
    glVertex3f(55,40,-75);
    glVertex3f(-55,40,-75);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(-55,0,-68);
    glVertex3f(55,0,-68);
    glVertex3f(55,5,-68);
    glVertex3f(-55,5,-68);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(-55,0,-68);
    glVertex3f(-85,0,-40);
    glVertex3f(-85,5,-40);
    glVertex3f(-55,5,-68);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(55,0,-68);
    glVertex3f(85,0,-40);
    glVertex3f(85,5,-40);
    glVertex3f(55,5,-68);
    glEnd();

//  tembokkiri
    glBegin(GL_LINE_LOOP);
    glVertex3f(-85,5,40);
    glVertex3f(-85,5,-40);
    glVertex3f(-85,40,-40);
    glVertex3f(-85,40,40);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(-85,0,-40);
    glVertex3f(-85,0,40);
    glVertex3f(-85,5,40);
    glVertex3f(-85,5,-40);
    glEnd();


//  tembokkanan
    glBegin(GL_LINE_LOOP);
    glVertex3f(85,5,40);
    glVertex3f(85,5,-40);
    glVertex3f(85,40,-40);
    glVertex3f(85,40,40);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(85,0,-40);
    glVertex3f(85,0,40);
    glVertex3f(85,5,40);
    glVertex3f(85,5,-40);
    glEnd();
    glBegin(GL_LINE_LOOP);
    glVertex3f(85,0,40);
    glVertex3f(55,0,68);
    glVertex3f(55,5,68);
    glVertex3f(85,5,40);
    glEnd();


     //sudut dinding
    glBegin(GL_LINE_LOOP);
    glVertex3f(-85,39.8,-40);
    glVertex3f(-85,5,-40);
    glVertex3f(-55,5,-68);
    glVertex3f(-54.9,40,-75.4);
    glEnd();

    glBegin(GL_LINE_LOOP);
    glVertex3f(85,39.8,-40);
    glVertex3f(85,5,-40);
    glVertex3f(55,5,-68);
    glVertex3f(54.9,40,-75.4);
    glEnd();

    glBegin(GL_LINE_LOOP);
    glVertex3f(85,39.8,40);
    glVertex3f(85,5,40);
    glVertex3f(55,5,68);
    glVertex3f(54.9,40,75.4);
    glEnd();

    glBegin(GL_LINE_LOOP);
    glVertex3f(-85,39.8,40);
    glVertex3f(-85,5,40);
    glVertex3f(-55,5,68);
    glVertex3f(-54.9,40,75.4);
    glEnd();
}

void pintu (void)
{
    //belakang
    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-50,0,-68.1);
    glVertex3f(-49,0,-68.1);
    glVertex3f(-49,3,-68.1);
    glVertex3f(-50,3,-68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-26,0,-68.1);
    glVertex3f(-25,0,-68.1);
    glVertex3f(-25,3,-68.1);
    glVertex3f(-26,3,-68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-2,0,-68.1);
    glVertex3f(-1,0,-68.1);
    glVertex3f(-1,3,-68.1);
    glVertex3f(-2,3,-68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(22,0,-68.1);
    glVertex3f(23,0,-68.1);
    glVertex3f(23,3,-68.1);
    glVertex3f(22,3,-68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(46,0,-68.1);
    glVertex3f(47,0,-68.1);
    glVertex3f(47,3,-68.1);
    glVertex3f(46,3,-68.1);
    glEnd();



    //depan
    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-50,0,68.1);
    glVertex3f(-49,0,68.1);
    glVertex3f(-49,3,68.1);
    glVertex3f(-50,3,68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-26,0,68.1);
    glVertex3f(-25,0,68.1);
    glVertex3f(-25,3,68.1);
    glVertex3f(-26,3,68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(-2,0,68.1);
    glVertex3f(-1,0,68.1);
    glVertex3f(-1,3,68.1);
    glVertex3f(-2,3,68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(22,0,68.1);
    glVertex3f(23,0,68.1);
    glVertex3f(23,3,68.1);
    glVertex3f(22,3,68.1);
    glEnd();

    glBegin(GL_POLYGON);
    glColor3ub(0,0,0);
    glVertex3f(46,0,68.1);
    glVertex3f(47,0,68.1);
    glVertex3f(47,3,68.1);
    glVertex3f(46,3,68.1);
    glEnd();

}

    void display(void)
   {
       if (is_depth)
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    else
    glClear(GL_COLOR_BUFFER_BIT);
    penonton();
    tembok();
    pintu();

    glPopMatrix();
    glutSwapBuffers();
   }

    void idle()
{
    if (!mouseDown)
    {
        xrot += 0.3f;
        yrot += 0.4f;
    }
    glutPostRedisplay();
}

void mouse(int button, int state, int x, int y)
{

    if (button == GLUT_LEFT_BUTTON && state == GLUT_DOWN)
    {
        mouseDown = true;
        xdiff = x - yrot;
        ydiff = -y + xrot;
    }
    else
        mouseDown = false;


}

void mouseMotion(int x, int y)
{
    asu();
    if (mouseDown)
    {
        yrot = x - xdiff;
        xrot = y + ydiff;

        glutPostRedisplay();
    }

}
void ukuran(int lebar, int tinggi)
{
    if (tinggi == 0) tinggi =1;

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(100, lebar / tinggi, 50, 500);
    glTranslated(0, -50, -150);
    glMatrixMode(GL_MODELVIEW);
    glViewport(0, 0, lebar / 1, tinggi / 1);

}

void keyboard(unsigned char key, int x, int y)
{

    switch(key)
    {
        case 'w':
        case 'W':
            glTranslated(0,0,3);
            break;
        case 'd':
        case 'D':
            glTranslated(3,0,0);
            break;
        case 's':
        case 'S':
            glTranslated(0,0,-3);
            break;
        case 'a':
        case 'A':
            glTranslated(-3,0,0);
            break;
        case '7':
            glTranslated(0,3,0);
            break;
        case '9':
            glTranslated(0,-3,0);
            break;
        case '2':
            glRotated(2,1,0,0);
            break;
        case '8':
            glRotated(-2,1,0,0);
            break;
        case '6':
            glRotated(2,0,1,0);
            break;
        case '4':
            glRotated(-2,1,0,0);
            break;
        case '1':
            glRotated(2,0,0,1);
            break;
        case '3':
            glRotated(-2,0,0,1);
            break;
        case '5':
            if (is_depth)
            {
                is_depth = 0;
                glEnable(GL_DEPTH_TEST);
            }
            else
            {
                is_depth = 1;
                glDisable(GL_DEPTH_TEST);
            }
    }
    display();


}

int main(int argc, char **argv){
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE);
    glutInitWindowPosition(250, 80);
    glutInitWindowSize(800, 600);
    glutCreateWindow("PENYU - 672018114_672018132");
    init();
    glutDisplayFunc(display);
    glutKeyboardFunc(keyboard);
    glutMouseFunc(mouse);
    glutMotionFunc(mouseMotion);
    glutReshapeFunc(ukuran);
    glutMainLoop();

    return 0;
}
